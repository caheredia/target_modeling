

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; target_modeling 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="models.predict_train_model" href="_autosummary/models.predict_train_model.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> target_modeling
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Project Organization</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Python Modules</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Load-raw-data">Load raw data</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Clean-raw-data">Clean raw data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Find-and-drop-dulicate-columns">Find and drop dulicate columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Drop-columns-that-have-&gt;-80%-missing-values">Drop columns that have &gt; 80% missing values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Drop-columns-with-low-variance,-data-type-int64-or-float64">Drop columns with low variance, data type int64 or float64</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Drop-Categorical-values-with-low-variance-by-converting-to-labels-to-dummy-variables-and-filtering-by-threshold-variance">Drop Categorical values with low variance by converting to labels to dummy variables and filtering by threshold variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Replace-NaN-values-in-numerical-columns-with-median-value-of-series">Replace NaN values in numerical columns with median value of series</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Find-date-like-columns-and-convert-to-timestamps,-then-to-integer-type">Find date like columns and convert to timestamps, then to integer type</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Save-cleaned-up-dataframe-as-csv">Save cleaned up dataframe as csv</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Load-cleaned-data">Load cleaned data</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Preprocess-data">Preprocess data</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Models">Models</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">target_modeling</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/0.1-cristian_explore_data.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Introduction">
<h1>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h1>
<p>This report analyzes the several machine learning models—Logistic
Regression, Stochastic Gradient Descent, Decision Tree, and Random
Forest—through model evaluation and the tuning of hyperparameters, which
are parameters that define the model. The chosen models where used
because they best handled large data sets with lots of features. The
features were cleaned up and transformed in the third section of the
Jupyter Notebook: Clean raw data.</p>
<p>In the Clean raw data section I removed mostly empty columns and
converted time like columns to time stamps, which were later converted
to integers for preprocessing. This last step separates the data set
into testing and training sets for model validation. In the
preprocessing the data is also scaled from 0 to 1, this helps the models
converge.</p>
<p>Once the notebook has been run once, the cleaned data will be saved into
a csv file. Then the notebook could be started from Section: Load
cleaned data.</p>
<p>The initial inspection of the data demonstrates an unbalanced data set,
with ~75% of data labeled 0; ~25%, 1. Wherever possible the models were
tuned to fit an unbalanced data set, with class_weight =’balanced’.
Given more time and familiarity with models, I would have included
Validation Curves to plot validation scores and training scores as a
function of model complexity.</p>
<p><strong>Summary</strong></p>
<p>Most of the models converged, however, some converged faster than
others. Logistic Regression yielded the best f1-score for items labeled
1. Logistic Regression also took the longest time to train. Conversely,
Random Forest yielded the best f1 score for items labels 0, and with the
shortest training time.</p>
<p><strong>Logistic Regression</strong></p>
<p>train time: 682.77s</p>
<p>test time: 0.32s</p>
<p>Accuracy Score: 0.67684</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">precision</span>    <span class="n">recall</span>  <span class="n">f1</span><span class="o">-</span><span class="n">score</span>   <span class="n">support</span>

<span class="mi">0</span>       <span class="mf">0.87</span>      <span class="mf">0.67</span>      <span class="mf">0.76</span>     <span class="mi">18705</span>
<span class="mi">1</span>       <span class="mf">0.42</span>      <span class="mf">0.71</span>      <span class="mf">0.52</span>      <span class="mi">6295</span>
</pre></div>
</div>
<p>micro avg 0.68 0.68 0.68 25000</p>
<p>macro avg 0.64 0.69 0.64 25000</p>
<p>weighted avg 0.76 0.68 0.70 25000</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Stochastic Gradient Descent</strong></td>
</tr>
<tr class="row-even"><td>train time: 6.00s</td>
</tr>
<tr class="row-odd"><td>test time: 0.04s</td>
</tr>
<tr class="row-even"><td>Accuracy Score: 0.58804</td>
</tr>
<tr class="row-odd"><td>precision recall f1-score support</td>
</tr>
<tr class="row-even"><td>0 0.82 0.58 0.68 18705 1 0.33 0.61 0.43 6295</td>
</tr>
<tr class="row-odd"><td>micro avg 0.59 0.59 0.59 25000</td>
</tr>
<tr class="row-even"><td>macro avg 0.57 0.60 0.55 25000</td>
</tr>
<tr class="row-odd"><td>weighted avg 0.69 0.59 0.62 25000</td>
</tr>
</tbody>
</table>
<p><strong>Decision Tree</strong></p>
<p>train time: 30.06s</p>
<p>test time: 0.14s</p>
<p>Accuracy Score: 0.65544</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">precision</span>    <span class="n">recall</span>  <span class="n">f1</span><span class="o">-</span><span class="n">score</span>   <span class="n">support</span>

<span class="mi">0</span>       <span class="mf">0.84</span>      <span class="mf">0.66</span>      <span class="mf">0.74</span>     <span class="mi">18705</span>
<span class="mi">1</span>       <span class="mf">0.39</span>      <span class="mf">0.63</span>      <span class="mf">0.48</span>      <span class="mi">6295</span>
</pre></div>
</div>
<p>micro avg 0.66 0.66 0.66 25000</p>
<p>macro avg 0.61 0.65 0.61 25000</p>
<p>weighted avg 0.73 0.66 0.68 25000</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Random Forest</strong></td>
</tr>
<tr class="row-even"><td>train time: 44.60s</td>
</tr>
<tr class="row-odd"><td>test time: 0.90s</td>
</tr>
<tr class="row-even"><td>Accuracy Score: 0.77708</td>
</tr>
<tr class="row-odd"><td>precision recall f1-score support</td>
</tr>
<tr class="row-even"><td>0 0.79 0.96 0.87 18705 1 0.67 0.23 0.34 6295</td>
</tr>
<tr class="row-odd"><td>micro avg 0.78 0.78 0.78 25000</td>
</tr>
<tr class="row-even"><td>macro avg 0.73 0.59 0.60 25000</td>
</tr>
<tr class="row-odd"><td>weighted avg 0.76 0.78 0.73 25000</td>
</tr>
</tbody>
</table>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>

<span class="kn">from</span> <span class="nn">src</span> <span class="k">import</span> <span class="n">find_duplicates</span><span class="p">,</span> <span class="n">find_empty_columns</span><span class="p">,</span> <span class="n">find_low_variance</span><span class="p">,</span> <span class="n">find_low_var_categories</span><span class="p">,</span> <span class="n">replace_NaN</span><span class="p">,</span> <span class="n">time_like</span><span class="p">,</span> <span class="n">convert_to_timestamp</span>
<span class="kn">from</span> <span class="nn">src</span> <span class="k">import</span> <span class="n">run_models</span><span class="p">,</span> <span class="n">model_dict</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div></div>
</div>
</div>
<div class="section" id="Load-raw-data">
<h1>Load raw data<a class="headerlink" href="#Load-raw-data" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;data/raw/targeting_model_data.csv&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/Users/cristian/anaconda/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2728: DtypeWarning: Columns (49,191,476) have mixed types. Specify dtype option on import or set low_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 100000 entries, 0 to 99999
Columns: 562 entries, FLOZVPMFT4626A to ibe9588SEUQO0831A
dtypes: float64(292), int64(129), object(141)
memory usage: 428.8+ MB
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of columns: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of rows: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of columns: 562
Number of rows: 100000
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># quick look at data</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FLOZVPMFT4626A</th>
      <th>ibe1270YRFHJ3350O</th>
      <th>ibe1270UUGLZ8167Q</th>
      <th>ibe1271DCBOP1538T</th>
      <th>ibe1271UEOXF6805V</th>
      <th>ibe1273MMNAC5195E</th>
      <th>ibe1273KQXUT2596F</th>
      <th>ibe1274DFDFF5102Q</th>
      <th>ibe1274BHMXG3244U</th>
      <th>ibe1275QYWDP9371S</th>
      <th>...</th>
      <th>ibe9588RHJVI3838A</th>
      <th>ibe9588PFUUV4361R</th>
      <th>ibe9588KHKHQ6606C</th>
      <th>ibe9588VBRCG7737V</th>
      <th>ibe9588LZKVW3171Q</th>
      <th>ibe9588XPLHJ3729U</th>
      <th>ibe9588AWQKW9305L</th>
      <th>ibe9588HVWQG4124G</th>
      <th>ibe9588YWABE2309I</th>
      <th>ibe9588SEUQO0831A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>17.0</td>
      <td>3</td>
      <td>12B</td>
      <td>3</td>
      <td>9.0</td>
      <td>E</td>
      <td>01C</td>
      <td>3</td>
      <td>01C</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1.0</td>
      <td>3</td>
      <td>11B</td>
      <td>3</td>
      <td>7.0</td>
      <td>E</td>
      <td>01C</td>
      <td>3</td>
      <td>01C</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>61.0</td>
      <td>3</td>
      <td>06X</td>
      <td>3</td>
      <td>12.0</td>
      <td>E</td>
      <td>03C</td>
      <td>3</td>
      <td>11C</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>13.0</td>
      <td>3</td>
      <td>12B</td>
      <td>3</td>
      <td>5.0</td>
      <td>E</td>
      <td>05C</td>
      <td>3</td>
      <td>07U</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>37.0</td>
      <td>3</td>
      <td>05X</td>
      <td>3</td>
      <td>7.0</td>
      <td>E</td>
      <td>05C</td>
      <td>3</td>
      <td>08C</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 562 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Composition of target data, this demonstrates imbalanced data. And thus accuracy alone is not a good metric for assessing performance of model.</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;FLOZVPMFT4626A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0    74528
1    25472
Name: FLOZVPMFT4626A, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="section" id="Clean-raw-data">
<h1>Clean raw data<a class="headerlink" href="#Clean-raw-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Find-and-drop-dulicate-columns">
<h2>Find and drop dulicate columns<a class="headerlink" href="#Find-and-drop-dulicate-columns" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">duplicates</span> <span class="o">=</span> <span class="n">find_duplicates</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of duplicate columns dropped: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">duplicates</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of duplicate columns dropped: 10
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># data frame excluding dropped columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">duplicates</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Drop-columns-that-have-&gt;-80%-missing-values">
<h2>Drop columns that have &gt; 80% missing values<a class="headerlink" href="#Drop-columns-that-have->-80%-missing-values" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">empty_columns</span> <span class="o">=</span> <span class="n">find_empty_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of mostly empty columns dropped: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">empty_columns</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of mostly empty columns dropped: 199
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># data frame excluding dropped columns</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">empty_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Drop-columns-with-low-variance,-data-type-int64-or-float64">
<h2>Drop columns with low variance, data type int64 or float64<a class="headerlink" href="#Drop-columns-with-low-variance,-data-type-int64-or-float64" title="Permalink to this headline">¶</a></h2>
<p>motivated by the Variance Threshold function
<a class="reference external" href="https://scikit-learn.org/stable/modules/feature_selection.html">https://scikit-learn.org/stable/modules/feature_selection.html</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># data frame excluding dropped columns</span>
<span class="n">low_var_columns</span> <span class="o">=</span> <span class="n">find_low_variance</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">low_var_columns</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of low variance columns dropped: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">low_var_columns</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of low variance columns dropped: 159
</pre></div></div>
</div>
</div>
<div class="section" id="Drop-Categorical-values-with-low-variance-by-converting-to-labels-to-dummy-variables-and-filtering-by-threshold-variance">
<h2>Drop Categorical values with low variance by converting to labels to dummy variables and filtering by threshold variance<a class="headerlink" href="#Drop-Categorical-values-with-low-variance-by-converting-to-labels-to-dummy-variables-and-filtering-by-threshold-variance" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">low_v_categories</span> <span class="o">=</span> <span class="n">find_low_var_categories</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">low_v_categories</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of low variance category columns dropped: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">low_v_categories</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of low variance category columns dropped: 7
</pre></div></div>
</div>
</div>
<div class="section" id="Replace-NaN-values-in-numerical-columns-with-median-value-of-series">
<h2>Replace NaN values in numerical columns with median value of series<a class="headerlink" href="#Replace-NaN-values-in-numerical-columns-with-median-value-of-series" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">=</span> <span class="n">replace_NaN</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Find-date-like-columns-and-convert-to-timestamps,-then-to-integer-type">
<h2>Find date like columns and convert to timestamps, then to integer type<a class="headerlink" href="#Find-date-like-columns-and-convert-to-timestamps,-then-to-integer-type" title="Permalink to this headline">¶</a></h2>
<p>Visually inspecting time like columns we can easily find columns that
are probably not meant to be timestamps</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time_columns</span> <span class="o">=</span> <span class="n">time_like</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">time_columns</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ibe6532KHUBA7864D</th>
      <th>ibe6533DZDLI9594P</th>
      <th>ibe8434JPYKM2838C</th>
      <th>ibe8579PIXYM2487A</th>
      <th>ibe8588DPLHE7435F</th>
      <th>ibe8592TOWAM1138U</th>
      <th>ibe8614UPZWA9445N</th>
      <th>ibe8643XQWMK2933S</th>
      <th>ibe8840PMLTL7040B</th>
      <th>ibe9042PFXFK2434Y</th>
      <th>ibe9047QMSFT7844Y</th>
      <th>ibe9052HKVXC1161K</th>
      <th>ibe9057AEWDA2240T</th>
      <th>ibe9152JHMZI9585O</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>20150513.0</td>
      <td>20140426.0</td>
      <td>2012.0</td>
      <td>200609.0</td>
      <td>1751.0</td>
      <td>1982.0</td>
      <td>20161.0</td>
      <td>200700.0</td>
      <td>24034.0</td>
      <td>2009.0</td>
      <td>20160106.0</td>
      <td>2007.0</td>
      <td>20160106.0</td>
      <td>20140900.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20141025.0</td>
      <td>20140804.0</td>
      <td>2011.0</td>
      <td>201107.0</td>
      <td>2957.0</td>
      <td>1997.0</td>
      <td>20153.0</td>
      <td>201107.0</td>
      <td>80785.0</td>
      <td>2003.0</td>
      <td>20160106.0</td>
      <td>1998.0</td>
      <td>20160106.0</td>
      <td>20141000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>20141215.0</td>
      <td>20140804.0</td>
      <td>2012.0</td>
      <td>200609.0</td>
      <td>1751.0</td>
      <td>1982.0</td>
      <td>20153.0</td>
      <td>200700.0</td>
      <td>24034.0</td>
      <td>2009.0</td>
      <td>20160106.0</td>
      <td>2007.0</td>
      <td>20160106.0</td>
      <td>20140300.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>20150707.0</td>
      <td>20140804.0</td>
      <td>2012.0</td>
      <td>200609.0</td>
      <td>1751.0</td>
      <td>1982.0</td>
      <td>20154.0</td>
      <td>201306.0</td>
      <td>24034.0</td>
      <td>2012.0</td>
      <td>20160106.0</td>
      <td>2007.0</td>
      <td>20160106.0</td>
      <td>20140100.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20151015.0</td>
      <td>20140804.0</td>
      <td>2013.0</td>
      <td>200811.0</td>
      <td>910.0</td>
      <td>1950.0</td>
      <td>20154.0</td>
      <td>200811.0</td>
      <td>87135.0</td>
      <td>2009.0</td>
      <td>20160106.0</td>
      <td>2007.0</td>
      <td>20160106.0</td>
      <td>20140300.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Visually inspecting items that are not potential time stamps</span>
<span class="n">not_time_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ibe8588DPLHE7435F&#39;</span><span class="p">,</span> <span class="s1">&#39;ibe8840PMLTL7040B&#39;</span><span class="p">]</span>
<span class="n">real_time_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">time_columns</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">not_time_columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># remove extra zeros from column</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;ibe9152JHMZI9585O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ibe9152JHMZI9585O&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">convert_to_timestamp</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">real_time_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[</span> <span class="n">real_time_columns</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ibe6532KHUBA7864D</th>
      <th>ibe6533DZDLI9594P</th>
      <th>ibe8434JPYKM2838C</th>
      <th>ibe8579PIXYM2487A</th>
      <th>ibe8592TOWAM1138U</th>
      <th>ibe8614UPZWA9445N</th>
      <th>ibe8643XQWMK2933S</th>
      <th>ibe9042PFXFK2434Y</th>
      <th>ibe9047QMSFT7844Y</th>
      <th>ibe9052HKVXC1161K</th>
      <th>ibe9057AEWDA2240T</th>
      <th>ibe9152JHMZI9585O</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1431475200000000000</td>
      <td>1398470400000000000</td>
      <td>1325376000000000000</td>
      <td>1136073600000000000</td>
      <td>378691200000000000</td>
      <td>1451606400000000000</td>
      <td>1167609600000000000</td>
      <td>1230768000000000000</td>
      <td>1452038400000000000</td>
      <td>1167609600000000000</td>
      <td>1452038400000000000</td>
      <td>1409529600000000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1414195200000000000</td>
      <td>1407110400000000000</td>
      <td>1293840000000000000</td>
      <td>1293840000000000000</td>
      <td>852076800000000000</td>
      <td>1425168000000000000</td>
      <td>1293840000000000000</td>
      <td>1041379200000000000</td>
      <td>1452038400000000000</td>
      <td>883612800000000000</td>
      <td>1452038400000000000</td>
      <td>1412121600000000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1418601600000000000</td>
      <td>1407110400000000000</td>
      <td>1325376000000000000</td>
      <td>1136073600000000000</td>
      <td>378691200000000000</td>
      <td>1425168000000000000</td>
      <td>1167609600000000000</td>
      <td>1230768000000000000</td>
      <td>1452038400000000000</td>
      <td>1167609600000000000</td>
      <td>1452038400000000000</td>
      <td>1393632000000000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1436227200000000000</td>
      <td>1407110400000000000</td>
      <td>1325376000000000000</td>
      <td>1136073600000000000</td>
      <td>378691200000000000</td>
      <td>1427846400000000000</td>
      <td>1356998400000000000</td>
      <td>1325376000000000000</td>
      <td>1452038400000000000</td>
      <td>1167609600000000000</td>
      <td>1452038400000000000</td>
      <td>1388534400000000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1444867200000000000</td>
      <td>1407110400000000000</td>
      <td>1356998400000000000</td>
      <td>1199145600000000000</td>
      <td>-631152000000000000</td>
      <td>1427846400000000000</td>
      <td>1199145600000000000</td>
      <td>1230768000000000000</td>
      <td>1452038400000000000</td>
      <td>1167609600000000000</td>
      <td>1452038400000000000</td>
      <td>1393632000000000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Save-cleaned-up-dataframe-as-csv">
<h2>Save cleaned up dataframe as csv<a class="headerlink" href="#Save-cleaned-up-dataframe-as-csv" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;data/interim/cleaned_columns.csv&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Load-cleaned-data">
<h1>Load cleaned data<a class="headerlink" href="#Load-cleaned-data" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;data/interim/cleaned_columns.csv&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FLOZVPMFT4626A</th>
      <th>ibe1270YRFHJ3350O</th>
      <th>ibe1271DCBOP1538T</th>
      <th>ibe1273MMNAC5195E</th>
      <th>ibe1274DFDFF5102Q</th>
      <th>ibe1275QYWDP9371S</th>
      <th>ibe1280ORQKP6566Z</th>
      <th>ibe1281AGNWU9303H</th>
      <th>ibe1281VSZLA4159S</th>
      <th>ibe2062AHFGH0763Q</th>
      <th>...</th>
      <th>ibe9153QSXNN0648A</th>
      <th>ibe9154GOSYR7154P</th>
      <th>ibe9180FFUYI1365V</th>
      <th>ibe9181PWJGU8847L</th>
      <th>ibe9350NHRIV6568X</th>
      <th>ibe9351VNIYI1676Y</th>
      <th>ibe9356VXVDJ5952B</th>
      <th>ibe9358UBJWE4744M</th>
      <th>ibe9509UGCNU4337M</th>
      <th>ibe9514RWCHD8503K</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>17.0</td>
      <td>12B</td>
      <td>9.0</td>
      <td>01C</td>
      <td>01C</td>
      <td>35.0</td>
      <td>09L</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>C1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>13.0</td>
      <td>5</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1.0</td>
      <td>11B</td>
      <td>7.0</td>
      <td>01C</td>
      <td>01C</td>
      <td>11.0</td>
      <td>04M</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>A1</td>
      <td>L1</td>
      <td>NaN</td>
      <td>4.0</td>
      <td>13.0</td>
      <td>B</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>61.0</td>
      <td>06X</td>
      <td>12.0</td>
      <td>03C</td>
      <td>11C</td>
      <td>38.0</td>
      <td>12L</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>25.0</td>
      <td>5.0</td>
      <td>1</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>13.0</td>
      <td>12B</td>
      <td>5.0</td>
      <td>05C</td>
      <td>07U</td>
      <td>14.0</td>
      <td>05M</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>M1</td>
      <td>NaN</td>
      <td>14.0</td>
      <td>5.0</td>
      <td>7</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>37.0</td>
      <td>05X</td>
      <td>7.0</td>
      <td>05C</td>
      <td>08C</td>
      <td>33.0</td>
      <td>11L</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>B6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>10.0</td>
      <td>6</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 187 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Preprocess-data">
<h1>Preprocess data<a class="headerlink" href="#Preprocess-data" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Load data</span>
<span class="n">X</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">values</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># split the data</span>
<span class="n">Xtrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">ytest</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Xtrain</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">Xtest</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(75000, 1287) (25000, 1287)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># preprocess data</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>  <span class="c1"># fit only on training data</span>
<span class="n">Xtrain</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">)</span>
<span class="n">Xtest</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">Xtest</span><span class="p">)</span>  <span class="c1"># apply same transformation to test data</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># verify preprocess is working correctly</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean of random array: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Std of random array: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">())))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mean of random array: 0.0
Std of random array: 1.0
</pre></div></div>
</div>
</div>
<div class="section" id="Models">
<h1>Models<a class="headerlink" href="#Models" title="Permalink to this headline">¶</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">run_models</span><span class="p">(</span><span class="n">Xtrain</span><span class="p">,</span> <span class="n">ytrain</span><span class="p">,</span> <span class="n">Xtest</span><span class="p">,</span> <span class="n">ytest</span><span class="p">,</span> <span class="n">model_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Logistic Regression
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/Users/cristian/anaconda/lib/python3.6/site-packages/sklearn/svm/base.py:922: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  &#34;the number of iterations.&#34;, ConvergenceWarning)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
train time: 682.77s
test time: 0.32s
Accuracy Score: 0.67684

              precision    recall  f1-score   support

           0       0.87      0.67      0.76     18705
           1       0.42      0.71      0.52      6295

   micro avg       0.68      0.68      0.68     25000
   macro avg       0.64      0.69      0.64     25000
weighted avg       0.76      0.68      0.70     25000

--------------------------------------------------------------------------------
Stochastic Gradient Descent
train time: 6.00s
test time: 0.04s
Accuracy Score: 0.58804

              precision    recall  f1-score   support

           0       0.82      0.58      0.68     18705
           1       0.33      0.61      0.43      6295

   micro avg       0.59      0.59      0.59     25000
   macro avg       0.57      0.60      0.55     25000
weighted avg       0.69      0.59      0.62     25000

--------------------------------------------------------------------------------
Decision Tree
train time: 30.06s
test time: 0.14s
Accuracy Score: 0.65544

              precision    recall  f1-score   support

           0       0.84      0.66      0.74     18705
           1       0.39      0.63      0.48      6295

   micro avg       0.66      0.66      0.66     25000
   macro avg       0.61      0.65      0.61     25000
weighted avg       0.73      0.66      0.68     25000

--------------------------------------------------------------------------------
Random Forest
train time: 44.60s
test time: 0.90s
Accuracy Score: 0.77708

              precision    recall  f1-score   support

           0       0.79      0.96      0.87     18705
           1       0.67      0.23      0.34      6295

   micro avg       0.78      0.78      0.78     25000
   macro avg       0.73      0.59      0.60     25000
weighted avg       0.76      0.78      0.73     25000

--------------------------------------------------------------------------------
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="_autosummary/models.predict_train_model.html" class="btn btn-neutral" title="models.predict_train_model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>